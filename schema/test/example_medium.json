{
  "document": {
    "csaf_version": "2.0",
    "publisher": {
      "type": "vendor"
    },
    "title": "Example Company Cross-Site-Scripting Vulnerability in Example Generator",
    "tracking": {
      "id": "Example Company - 2019-YH3234",
      "current_release_date": "2020-09-03",
      "generator": {
        "engine": "time-waits-for-no-one v2020.09.03.20200903232323"
      },
      "initial_release_date": "2020-09-03",
      "revision_history": [
        {
          "number": "1",
          "date": "2020-09-03",
          "description": "Initialsecurity advisory."
        }
      ],
      "status": "draft",
      "version": "1"
    },
    "type": "Vendor Security Advisory"
  },
  "product_tree": {
    "$comment": "Currently only supports branch_t and full_product_name_t children of product_tree",
    "type": "object",
    "minProperties": 1,
    "properties": {
      "branches": {
        "type": "array",
        "minItems": 1,
        "items": {
          "$ref": "#/definitions/branch_branches_t"
        }
      },
      "full_product_names": {
        "type": "array",
        "minItems": 1,
        "items": {
          "$ref": "#/definitions/full_product_name_t"
        }
      },
      "product_groups": {
        "type": "array",
        "minItems": 1,
        "items": {
          "title": "Product group",
          "description": "Defines a new logical group of products that can then be referred to in other parts of the document to address a group of products with a single identifier.",
          "type": "object",
          "required": [
            "group_id",
            "product_ids"
          ],
          "properties": {
            "description": {
              "title": "Description of the product group",
              "description": "Gives a short, optional description of the group.",
              "examples": [
                "The x64 versions of the operating system.",
                "Products supporting Modbus."
              ],
              "type": "string",
              "minLength": 1
            },
            "group_id": {
              "$ref": "#/definitions/product_group_id_t"
            },
            "product_ids": {
              "title": "List of product_ids",
              "description": "Lists the product_ids of those products which known as one group in the document.",
              "type": "array",
              "minItems": 2,
              "items": {
                "$ref": "#/definitions/product_id_t"
              }
            }
          }
        }
      },
      "relationships": {
        "type": "array",
        "minItems": 1,
        "items": {
          "title": "Relationship",
          "description": "Establishes a link between two existing full_product_name_t elements, allowing the document producer to define a combination of two products that form a new full_product_name entry.",
          "type": "object",
          "properties": {
            "full_product_names": {
              "type": "array",
              "minItems": 1,
              "items": {
                "$ref": "#/definitions/full_product_name_t"
              }
            },
            "product_reference": {
              "$ref": "#/definitions/product_id_t"
            },
            "relates_to_product_reference": {
              "$ref": "#/definitions/product_id_t"
            },
            "relationship_type": {
              "title": "Relationship type",
              "description": "Defines the type of relationship for the referenced component.",
              "type": "string",
              "enum": [
                "default_component_of",
                "optional_component_of",
                "external_component_of",
                "installed_on",
                "installed_with"
              ]
            }
          },
          "required": [
            "product_reference",
            "relates_to_product_reference",
            "relationship_type"
          ]
        }
      }
    }
  },
  "vulnerabilities": {
    "type": "array",
    "minItems": 1,
    "items": {
      "title": "Vulnerability",
      "description": "Is a container for the aggregation of all fields that are related to a single vulnerability in the document.",
      "type": "object",
      "minProperties": 1,
      "properties": {
        "acknowledgments": {
          "type": "array",
          "minItems": 1,
          "items": {
            "$ref": "#/definitions/acknowledgment_t"
          }
        },
        "cve": {
          "type": "string",
          "pattern": "^CVE-[0-9]{4}-[0-9]{4,}$"
        },
        "cwe": {
          "type": "object",
          "properties": {
            "id": {
              "type": "string",
              "pattern": "^CWE-[1-9]\\d{0,5}$"
            },
            "description": {
              "type": "string",
              "minLength": 1
            }
          }
        },
        "scores": {
          "type": "array",
          "minItems": 1,
          "items": [
            {
              "anyOf": [
                {
                  "type": "array",
                  "minItems": 0,
                  "items": {
                    "$ref": "#/definitions/products_t",
                    "examples": [
                      "CVRFID_123",
                      "CSAFID_0815"
                    ],
                    "default": ""
                  }
                },
                {
                  "type": "object",
                  "properties": {
                    "cvss_v20": {
                      "$ref": "https://www.first.org/cvss/cvss-v2.0.json"
                    }
                  }
                },
                {
                  "type": "object",
                  "properties": {
                    "cvss_v30": {
                      "$ref": "https://www.first.org/cvss/cvss-v3.0.json"
                    }
                  }
                },
                {
                  "type": "object",
                  "properties": {
                    "cvss_v31": {
                      "$ref": "https://www.first.org/cvss/cvss-v3.1.json"
                    }
                  }
                }
              ]
            }
          ]
        },
        "discovery_date": {
          "type": "string",
          "format": "date-time"
        },
        "id": {
          "type": "object",
          "properties": {
            "system_name": {
              "title": "System name",
              "description": "Indicates the name of the vulnerability tracking or numbering system.",
              "type": "string",
              "minLength": 1
            },
            "text": {
              "type": "string",
              "minLength": 1
            }
          },
          "required": [
            "system_name",
            "text"
          ]
        },
        "involvements": {
          "type": "array",
          "minItems": 1,
          "items": {
            "title": "Involvement",
            "description": "Is a container, that allows the document producers to comment on their level of Involvement (or engagement) in the vulnerability identification, scoping, and remediation process.",
            "type": "object",
            "required": [
              "party",
              "status"
            ],
            "properties": {
              "description": {
                "type": "string",
                "minLength": 1
              },
              "party": {
                "title": "Party type",
                "description": "Defines the type of the involved party.",
                "type": "string",
                "enum": [
                  "coordinator",
                  "discoverer",
                  "other",
                  "user",
                  "vendor"
                ]
              },
              "status": {
                "title": "Party status",
                "description": "Defines contact status of the involved party.",
                "type": "string",
                "enum": [
                  "completed",
                  "contact_accepted",
                  "disputed",
                  "in_progress",
                  "not_contacted",
                  "open"
                ]
              }
            }
          }
        },
        "notes": {
          "$ref": "#/definitions/notes_t"
        },
        "product_status": {
          "title": "Product status",
          "description": "Contains different lists of product_ids which provide details on the status of the referenced product related to the current vulnerability. ",
          "type": "object",
          "minProperties": 1,
          "properties": {
            "fixed": {
              "title": "Fixed",
              "description": "These versions contain a fix for the vulnerability but may not be the recommended fixed versions.",
              "$ref": "#/definitions/products_t"
            },
            "first_fixed": {
              "title": "First fixed",
              "description": "These versions contain the first fix for the vulnerability but may not be the recommended fixed versions.",
              "$ref": "#/definitions/products_t"
            },
            "recommended": {
              "title": "Recommended",
              "description": "These versions have a fix for the vulnerability and are the vendor-recommended versions for fixing the vulnerability.",
              "$ref": "#/definitions/products_t"
            },
            "known_affected": {
              "title": "Known affected",
              "description": "These versions are known to be affected by the vulnerability.",
              "$ref": "#/definitions/products_t"
            },
            "first_affected": {
              "title": "First affected",
              "description": "These are the first versions of the releases known to be affected by the vulnerability.",
              "$ref": "#/definitions/products_t"
            },
            "last_affected": {
              "title": "Last affected",
              "description": "These are the last versions in a release train known to be affected by the vulnerability. Subsequently released versions would contain a fix for the vulnerability.",
              "$ref": "#/definitions/products_t"
            },
            "known_not_affected": {
              "title": "Known not affected",
              "description": "These versions are known not to be affected by the vulnerability.",
              "$ref": "#/definitions/products_t"
            },
            "under_investigation": {
              "title": "Under investigation",
              "description": "It is not known yet whether this version is or is not affected by the vulnerability. However, it is still under investigation - the result will be provided in a later release of the document.",
              "$ref": "#/definitions/products_t"
            }
          }
        },
        "references": {
          "$ref": "#/definitions/references_t"
        },
        "release_date": {
          "type": "string",
          "format": "date-time"
        },
        "remediations": {
          "type": "array",
          "minItems": 1,
          "items": {
            "title": "Remedation",
            "description": "Specifies details on how to handle (and presumably, fix) a vulnerability.",
            "type": "object",
            "required": [
              "description",
              "type"
            ],
            "properties": {
              "date": {
                "type": "string",
                "format": "date-time"
              },
              "description": {
                "title": "Description of the remediation",
                "description": "Contains a thorough human-readable discussion of the remediation.",
                "type": "string",
                "minLength": 1
              },
              "entitlements": {
                "type": "array",
                "minItems": 1,
                "items": {
                  "title": "Entitlement of the remediation",
                  "description": "Contains any possible vendor-defined constraints for obtaining fixed software or hardware that fully resolves the vulnerability.",
                  "type": "string",
                  "minLength": 1
                }
              },
              "group_ids": {
                "$ref": "#/definitions/product_groups_t"
              },
              "product_ids": {
                "$ref": "#/definitions/products_t"
              },
              "restart_required": {
                "title": "Restart required by remediation",
                "description": "Provides information on type of restart is required by this remediation to become effective.",
                "type": "object",
                "required": [
                  "type"
                ],
                "properties": {
                  "type": {
                    "title": "Type of restart",
                    "description": "Specifies what type of restart is required by this remediation to become effective.",
                    "type": "string",
                    "enum": [
                      "none",
                      "vulnerable_component",
                      "service",
                      "parent",
                      "dependencies",
                      "connected",
                      "machine",
                      "zone",
                      "system"
                    ]
                  },
                  "description": {
                    "title": "Additional restart information",
                    "description": "Provides additional information for the restart. This can include details on procedures, scope or impact.",
                    "type": "string",
                    "minLength": 1
                  }
                }
              },
              "type": {
                "title": "Type of the remediation",
                "description": "Specifies the type which this remediation belongs to.",
                "type": "string",
                "enum": [
                  "workaround",
                  "mitigation",
                  "vendor_fix",
                  "none_available",
                  "no_fix_planned"
                ]
              },
              "url": {
                "title": "URL to the remediation",
                "description": "Contains the URL where to obtain the remediation.",
                "type": "string",
                "format": "uri"
              }
            }
          }
        },
        "threats": {
          "type": "array",
          "minItems": 1,
          "items": {
            "title": "Threat",
            "description": "Contains the vulnerability kinetic information. This information can change as the vulnerability ages and new information becomes available.",
            "type": "object",
            "required": [
              "description",
              "type"
            ],
            "properties": {
              "type": {
                "title": "Type of the threat",
                "description": "Categorizes the threat according to the rules of the specification.",
                "type": "string",
                "enum": [
                  "impact",
                  "exploit_status",
                  "target_set"
                ]
              },
              "description": {
                "title": "Description of the threat",
                "description": "Represents a thorough human-readable discussion of the threat.",
                "type": "string",
                "minLength": 1
              },
              "date": {
                "type": "string",
                "format": "date-time"
              },
              "product_ids": {
                "$ref": "#/definitions/products_t"
              },
              "group_ids": {
                "$ref": "#/definitions/product_groups_t"
              }
            }
          }
        },
        "title": {
          "type": "string",
          "minLength": 1
        }
      }
    }
  }
}
